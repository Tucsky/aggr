var t=Object.defineProperty,e=(e,s,i)=>(((e,s,i)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i})(e,"symbol"!=typeof s?s+"":s,i),i);import{n as s,S as i,t as o,D as n,az as a,aA as r,w as l,z as c,d,ab as u,a2 as h,at as p,au as m,aB as f,ax as g,C as v,ar as y,V as b,H as _,aC as C,v as A,af as T,l as w,r as x,T as S,p as k,y as E}from"./index.5c4cb14.js";import{P as I}from"./paneDialogMixin.5c4cb14.js";import{T as L}from"./ToggableGroup.5c4cb14.js";const O=["gain"],$=["holdDuration","fadeIn","fadeOut"];const D=s({components:{Slider:i,DropdownButton:o},props:{type:{required:!0,type:String},error:{required:!1,type:String}},mixins:[n],data:()=>({url:null,frequencyHz:null,gain:null,fadeOut:null,delay:null,fadeIn:null,holdDuration:null,osc:null,startGain:null,endGain:null,startTime:null,dynamicGain:!0,dynamicLength:!0,uploadedSound:null,showAdvanced:!1}),computed:{title(){return"play"===this.type?"Synthetize sound":"Import your own"},descriptions:()=>a,frequency:{get(){return this.frequencyHz},set(t){isNaN(t)?this.frequencyHz=this.noteToFrequency(t):this.frequencyHz=+t}},litteral(){const t=r[this.type],e=Object.keys(t).map((e=>this.dynamicGain&&-1!==O.indexOf(e)||this.dynamicLength&&-1!==$.indexOf(e)?this[e]?"gain*"+this[e]:0!=t[e]?0:null:this[e]!=t[e]?this[e]:null));for(let s=e.length-1;s>=0&&null===e[s];s--)e.splice(s,1);return`${this.type}(${e.map((t=>null===t?"":t))})`}},created(){this.setDefaultAudioAttributes()},beforeDestroy(){this.uploadedSound&&l.removeSound(this.uploadedSound).then((()=>{this.$store.dispatch("app/showNotice",{title:`Deleted ${this.uploadedSound} (canceled)`,type:"info"})}))},methods:{setDefaultAudioAttributes(){const t=r[this.type];for(const e in t)this[e]=t[e]},noteToFrequency(t){let e,s;return e=3===t.length?t.charAt(2):t.charAt(1),s=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"].indexOf(t.slice(0,-1)),s=s<3?s+12+12*(e-1)+1:s+12*(e-1)+1,+(440*Math.pow(2,(s-49)/12)).toFixed(2)},async handleFile(t){const e=t.target.files[0];if(e)try{const t=await c.importSound(e);t?(this.uploadedSound&&l.removeSound(this.uploadedSound),this.uploadedSound=this.url=t.name):this.url=e.name}catch(s){return void this.$store.dispatch("app/showNotice",{title:s.message,type:"error"})}},reset(t){const e=r[this.type][t];this[t]=e},submit(){this.$emit("append",{litteral:this.litteral,uploadedSound:this.uploadedSound}),this.uploadedSound=null,this.close()}}},(function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"pane-dialog -auto",on:{clickOutside:t.close,mousedown:function(e){t.clickOutsideClose=!1},mouseup:function(e){t.clickOutsideClose=!0}},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"dialog__title"},[t._v(t._s(t.title))])]},proxy:!0},{key:"footer",fn:function(){return[e("a",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text mrauto",attrs:{href:"javascript:void(0);",title:"Restart audio service (clear ALL queue)"},on:{click:function(e){return t.$emit("stop")}}},[e("i",{staticClass:"icon-refresh mr8"}),t._v(" Restart audio ")]),e("a",{staticClass:"btn -text mr8",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.close(!1)}}},[t._v("Cancel")]),e("button",{staticClass:"btn -large",on:{click:t.submit}},[e("i",{staticClass:"icon-check mr4"}),t._v(" Ok ")])]},proxy:!0}])},["play"===t.type?e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:"audio-assistant-source"}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Frequency "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.frequency}})]),e("div",{staticClass:"column"},[e("slider",{staticClass:"mrauto -fill mt8 mb8",attrs:{min:0,max:8902,step:1,label:!0,"show-completion":!0,value:t.frequency},on:{input:function(e){t.frequency=e},reset:function(e){return t.reset("frequency")}}}),e("editable",{staticClass:"-center text-nowrap ml8",staticStyle:{"line-height":"1"},attrs:{value:t.frequency},on:{input:function(e){t.frequency=e}}})],1)]):e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:"audio-assistant-source"}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Source ")]),e("button",{staticClass:"btn -file -blue -large -cases w-100",on:{change:t.handleFile}},[e("i",{staticClass:"icon-upload mr8"}),t._v(" Browse "),e("input",{staticClass:"input-file",attrs:{type:"file",accept:"audio/*"}})])]),e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Gain "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.gain}})]),e("div",{staticClass:"column"},[e("slider",{attrs:{min:0,max:2,step:.01,label:!0,"show-completion":!0,value:t.gain},on:{input:function(e){t.gain=e},reset:function(e){return t.reset("gain")}}}),e("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input",attrs:{title:"Dynamic"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.dynamicGain,expression:"dynamicGain"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.dynamicGain)?t._i(t.dynamicGain,null)>-1:t.dynamicGain},on:{change:function(e){var s=t.dynamicGain,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&(t.dynamicGain=s.concat([null])):n>-1&&(t.dynamicGain=s.slice(0,n).concat(s.slice(n+1)))}else t.dynamicGain=o}}}),e("div")])],1)]),e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Duration "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.holdDuration}})]),e("div",{staticClass:"column"},[e("slider",{attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.holdDuration},on:{input:function(e){t.holdDuration=e},reset:function(e){return t.reset("holdDuration")}}}),e("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input",attrs:{title:"Dynamic"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.dynamicLength,expression:"dynamicLength"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.dynamicLength)?t._i(t.dynamicLength,null)>-1:t.dynamicLength},on:{change:function(e){var s=t.dynamicLength,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&(t.dynamicLength=s.concat([null])):n>-1&&(t.dynamicLength=s.slice(0,n).concat(s.slice(n+1)))}else t.dynamicLength=o}}}),e("div")])],1)]),e("section",{staticClass:"section"},[t.showAdvanced?e("div",["play"===t.type?e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Wave type ("),e("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/OscillatorNode/type"}},[t._v("learn more")]),t._v(")")]),e("dropdown-button",{staticClass:"-outline form-control -arrow",attrs:{options:["'triangle'","'square'","'sine'","'sawtooth'"]},on:{input:function(e){t.osc=e}},scopedSlots:t._u([{key:"selection",fn:function(){return[t._v(" "+t._s(t.osc.replace(/'/g,""))+" ")]},proxy:!0},{key:"option",fn:function({value:e}){return[t._v(" "+t._s(e.replace(/'/g,""))+" ")]}}],null,!1,2424831711),model:{value:t.osc,callback:function(e){t.osc=e},expression:"osc"}})],1):t._e(),e("div",{staticClass:"column mb16"},[e("div",{staticClass:"form-group -fill"},[e("label",[t._v("Fade In "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.fadeIn}})]),e("slider",{staticClass:"mt8",attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.fadeIn},on:{input:function(e){t.fadeIn=e},reset:function(e){return t.reset("fadeIn")}}})],1),e("div",{staticClass:"ml8 form-group -fill"},[e("label",[t._v("Fade Out "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.fadeOut}})]),e("slider",{staticClass:"mt8",attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.fadeOut},on:{input:function(e){t.fadeOut=e},reset:function(e){return t.reset("fadeOut")}}})],1)]),e("div",{staticClass:"column mb16"},[e("div",{staticClass:"form-group -fill"},[e("label",[t._v("Start Gain "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.startGain}})]),e("slider",{staticClass:"mt8",attrs:{min:1e-4,max:1,step:.001,label:!0,"show-completion":!0,value:t.startGain},on:{input:function(e){t.startGain=e},reset:function(e){return t.reset("startGain")}}})],1),e("div",{staticClass:"ml8 form-group -fill"},[e("label",[t._v("End Gain "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.endGain}})]),e("slider",{staticClass:"mt8",attrs:{min:1e-4,max:1,step:.001,label:!0,"show-completion":!0,value:t.endGain},on:{input:function(e){t.endGain=e},reset:function(e){return t.reset("endGain")}}})],1)]),e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Delay "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.delay}})]),e("slider",{staticClass:"mt8",attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.delay},on:{input:function(e){t.delay=e},reset:function(e){return t.reset("delay")}}})],1)]):t._e(),e("div",{staticClass:"section__header",on:{click:function(e){t.showAdvanced=!t.showAdvanced}}},[t._v(" Advanced "),e("i",{staticClass:"icon-up-thin"})])]),e("div",{staticClass:"form-group mt16"},[e("label",{attrs:{for:"audio-assistant-output"}},[t._v(" Output ")]),e("div",{staticClass:"d-flex"},[e("textarea",{ref:"output",staticClass:"form-control",attrs:{id:"audio-assistant-output -code",cols:"20",rows:"4",spellcheck:"false",readonly:""},domProps:{value:t.litteral}}),e("button",{staticClass:"btn -red ml8",on:{click:function(e){return t.$emit("test",{event:e,litteral:t.litteral})}}},[e("i",{staticClass:"icon-volume-high"})])]),t.error?e("p",{staticClass:"form-feedback"},[e("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.error)+" ")]):t._e()])])}),[],!1,null,null,null,null).exports;const P=s({props:{paneId:{required:!0,type:String},thresholds:{required:!0},thresholdId:{required:!0,type:String}},mixins:[n],data:()=>({buyAudio:"",sellAudio:"",buyError:null,sellError:null,showHelp:!1,focusedSide:null,loopingSide:null,dropping:null,liveAnnotation:null,uploadedSounds:[]}),computed:{threshold:function(){return this.thresholds.find((t=>t.id===this.thresholdId))},amounts:function(){return this.thresholds.map((t=>t.amount))},audioPitch:function(){return this.$store.state[this.paneId].audioPitch},audioVolume:function(){return this.$store.state[this.paneId].audioVolume},index:function(){return this.amounts.indexOf(this.threshold.amount)},min:function(){return this.threshold.amount},max:function(){return this.amounts[this.index+1]||2*this.amounts[this.index]}},created(){if(!this.threshold)return this.$nextTick().then((()=>this.close(!1)));this.buyAudio=this.threshold.buyAudio||"",this.sellAudio=this.threshold.sellAudio||""},beforeDestroy(){this._loopingTimeout&&(clearTimeout(this._loopingTimeout),this._loopingTimeout=!1);for(const t of this.uploadedSounds)l.removeSound(t).then((()=>{this.$store.dispatch("app/showNotice",{title:`Deleted ${t} (canceled)`,type:"info"})}))},methods:{setInput(t,e){this[e+"Audio"]=t,this.liveAnnotation=null},saveInputs(){this.validate(!0)&&(this.$store.commit(this.paneId+"/SET_THRESHOLD_AUDIO",{id:this.thresholdId,buyAudio:this.buyAudio,sellAudio:this.sellAudio}),this.uploadedSounds.splice(0,this.uploadedSounds.length),this.close(!0))},validate(t=!1){for(const s of["buy","sell"]){const i=this[s+"Audio"];try{this.emulateAudioFunction(i,s)}catch(e){return t&&d.confirm({message:`Please check that ${s} audio script is syntactically correct.`,ok:"OK",cancel:!1}),!1}}return!0},async testCustom(t,e,s){return this._loopingTimeout&&this.stopLoop(),s||(s=this[t+"Audio"]),await this.test(s,t,e)},testOriginal(t,e){this._loopingTimeout&&this.stopLoop();const s=this.threshold[t+"Audio"];this.test(s,t,e)},stopLoop(){this._loopingTimeout&&(clearTimeout(this._loopingTimeout),this._loopingTimeout=!1,this.loopingSide=null)},loopSide(t){this._loopingTimeout||(this.loopingSide=t),this._loopingTimeout=setTimeout((()=>{this.test(this[t+"Audio"],t),this.loopSide(t)}),100*Math.random())},restartWebAudio(){u.reconnect()},async test(t,e,s){let i,o=1;const n=this.max-this.min;if(s&&s.shiftKey||!n?i=this.min:(i=this.min+Math.random()*n,o=i/this.amounts[1]),i){const n=await this.emulateAudioFunction(t,e,o);return n&&s&&this.$store.dispatch("app/showNotice",{id:"testing-threshold-audio",type:"buy"===e?"success":"error",title:"NOW PLAYING : "+h(i)+" "+e.toUpperCase()+" trade",timeout:1e3}),n}},formatAmount:t=>h(t),async emulateAudioFunction(t,e,s){try{const i=await u.buildAudioFunction(t,e,this.audioPitch,this.audioVolume,!0);return void 0!==s&&i(u,s),this[e+"Error"]=null,!0}catch(i){return this[e+"Error"]=i.message,!1}},openSoundAssistant(t,e){const s=d.open(D,{type:t,error:this[e+"Error"]});s.$on("test",(({event:t,litteral:s})=>this.testCustom(e,t,s))),s.$on("stop",this.restartWebAudio),s.$on("append",(({litteral:t,uploadedSound:s})=>{s&&this.uploadedSounds.push(s),this[e+"Audio"].trim().length?this[e+"Audio"]+=`\n${t}`:this[e+"Audio"]=t}))},handleDropEnter(t){this.dropping=t},handleDropLeave(t){t.target===t.currentTarget&&(this.dropping=null)},async handleDrop(t,e){if(t.dataTransfer.files&&t.dataTransfer.files.length){if(t.preventDefault(),t.stopPropagation(),"drop"!==t.type)return!1;for(const s of t.dataTransfer.files)await this.importSound(s,e);this.dropping=null}},async importSound(t,e){try{const s=await c.importSound(t);s&&this.uploadedSounds.push(s.name);const i=`playurl(${t.name})`;this[e+"Audio"].trim().length?this[e+"Audio"]+=`\n${i}`:this[e+"Audio"]=i}catch(s){return void this.$store.dispatch("app/showNotice",{title:s.message,type:"error"})}},async scheduleLiveAnnotation(t,e){this.focusedSide=e,this._liveAnnotationTimeout&&clearTimeout(this._liveAnnotationTimeout),this._liveAnnotationTimeout=setTimeout(this.findCurrentParameter.bind(this,t.currentTarget,e),200)},findCurrentParameter(t){if(this._liveAnnotationTimeout=null,!("selectionStart"in t)||document.activeElement!=t)return;let e=t.selectionStart-1,s=t.value.slice(),i=e;for(;i>=0;i--){if(/\n/.test(s[i])){i++;break}0===i&&e--}i>=0&&(s=s.slice(i)),e-=i;const o=s.indexOf("\n");if(o>=0&&(s=s.slice(0,o)),!s.length)return;const n=new RegExp("(play(?:url)?)\\(","g");let a;do{if(a=n.exec(s)){const t=a[1],i=a.index,o=p(s,i+t.length);if(e<i+t.length||e>=o)continue;const n=m(s.slice(i+t.length+1,o),!1,5);let r=i+t.length+1;for(let s=0;s<n.length;s++){if(e<=r+n[s].length-1)return void this.showParameterAnnotation(t,s);r+=n[s].length+1}}}while(a);this.liveAnnotation&&(this.liveAnnotation=null)},showParameterAnnotation(t,e){let s;const i=f[t][e];s=i?`${i.toUpperCase()} : ${a[i]}`:`Too many parameters on ${t}() !`,this.liveAnnotation=s},reset(t){const e=JSON.parse(JSON.stringify(g[this.$store.state.panes.panes[this.paneId].type].state));e.thresholds[Math.min(this.index,3)]&&(this[t+"Audio"]=e.thresholds[Math.min(this.index,3)][t+"Audio"])}}},(function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"pane-dialog -auto",on:{clickOutside:t.close,mousedown:function(e){t.clickOutsideClose=!1},mouseup:function(e){t.clickOutsideClose=!0}},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"dialog__title -center"},[t._v("Threshold")]),e("code",{staticClass:"ml4 -filled"},[e("small",[t._v(t._s(t.formatAmount(t.threshold.amount)))])])])]},proxy:!0},{key:"footer",fn:function(){return[e("a",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text mrauto",attrs:{href:"javascript:void(0);",title:"Restart audio service (clear ALL queue)"},on:{click:function(e){return t.restartWebAudio()}}},[e("i",{staticClass:"icon-refresh mr8"}),t._v(" Restart audio ")]),e("a",{staticClass:"btn -text mr8",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.close(!1)}}},[t._v("Cancel")]),e("button",{staticClass:"btn -large -green",on:{click:function(e){return t.saveInputs()}}},[e("i",{staticClass:"icon-check mr4"}),t._v(" Save ")])]},proxy:!0}])},[e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:""}},[t._v(" When buy ")]),t.liveAnnotation&&"buy"===t.focusedSide?e("div",{staticClass:"live-annotation"},[e("div",{staticClass:"live-annotation__tooltip"},[t._v(t._s(t.liveAnnotation))])]):t._e(),e("div",{staticClass:"d-flex",on:{drop:function(e){return t.handleDrop(e,"buy")},dragover:function(e){return t.handleDrop(e,"buy")},dragenter:function(e){return t.handleDropEnter("buy")},dragleave:t.handleDropLeave}},[t.buyAudio!==t.threshold.buyAudio?e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -green mr8",attrs:{title:"Original"},on:{click:function(e){return t.testOriginal("buy",e)}}},[e("i",{staticClass:"icon-volume-high"})]):t._e(),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.buyAudio,expression:"buyAudio"}],staticClass:"form-control -code",class:["buy"===t.dropping&&"-dropping"],domProps:{value:t.buyAudio},on:{blur:function(e){t.liveAnnotation=null},focus:function(e){return t.scheduleLiveAnnotation(e,"buy")},keyup:function(e){return t.scheduleLiveAnnotation(e,"buy")},click:function(e){return t.scheduleLiveAnnotation(e,"buy")},input:function(e){e.target.composing||(t.buyAudio=e.target.value)}}}),e("button",{staticClass:"btn -green ml8",class:["buy"===t.loopingSide&&"shake-hard"],attrs:{title:"Custom"},on:{click:function(e){return t.testCustom("buy",e)},dblclick:function(e){return t.loopSide("buy")}}},[e("i",{staticClass:"icon-volume-high"})])]),"buy"===t.focusedSide?e("div",{staticClass:"mt8 d-flex"},[e("button",{staticClass:"btn -green -small",on:{click:function(e){return t.openSoundAssistant("play","buy")}}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Synthetize sound ")]),e("button",{staticClass:"btn -green -small ml8 mr8",on:{click:function(e){return t.openSoundAssistant("playurl","buy")}}},[e("i",{staticClass:"icon-upload mr8"}),t._v(" Import audio ")]),e("button",{staticClass:"btn -small -red mlauto -text",on:{click:function(e){return t.reset("buy")}}},[e("i",{staticClass:"icon-eraser mr8"}),t._v(" Reset ")])]):t._e(),t.buyError?e("p",{staticClass:"form-feedback"},[e("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.buyError)+" ")]):t._e()]),e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:""}},[t._v(" When sell ")]),t.liveAnnotation&&"sell"===t.focusedSide?e("div",{staticClass:"live-annotation"},[e("div",{staticClass:"live-annotation__tooltip"},[t._v(t._s(t.liveAnnotation))])]):t._e(),e("div",{staticClass:"d-flex",on:{drop:function(e){return t.handleDrop(e,"sell")},dragover:function(e){return t.handleDrop(e,"sell")},dragenter:function(e){return t.handleDropEnter("sell")},dragleave:t.handleDropLeave}},[t.sellAudio!==t.threshold.sellAudio?e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -red mr8",attrs:{title:"Original"},on:{click:function(e){return t.testOriginal("sell",e)}}},[e("i",{staticClass:"icon-volume-high"})]):t._e(),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.sellAudio,expression:"sellAudio"}],staticClass:"form-control -code",class:["sell"===t.dropping&&"-dropping"],domProps:{value:t.sellAudio},on:{blur:function(e){t.liveAnnotation=null},focus:function(e){return t.scheduleLiveAnnotation(e,"sell")},keyup:function(e){return t.scheduleLiveAnnotation(e,"sell")},click:function(e){return t.scheduleLiveAnnotation(e,"sell")},input:function(e){e.target.composing||(t.sellAudio=e.target.value)}}}),e("button",{staticClass:"btn -red ml8",class:["sell"===t.loopingSide&&"shake-hard"],on:{click:function(e){return t.testCustom("sell",e)},dblclick:function(e){return t.loopSide("sell")}}},[e("i",{staticClass:"icon-volume-high"})])]),"sell"===t.focusedSide?e("div",{staticClass:"mt8 d-flex"},[e("button",{staticClass:"btn -red -small",on:{click:function(e){return t.openSoundAssistant("play","sell")}}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Synthetize sound ")]),e("button",{staticClass:"btn -red -small ml8 mr8",on:{click:function(e){return t.openSoundAssistant("playurl","sell")}}},[e("i",{staticClass:"icon-upload mr8"}),t._v(" Import audio ")]),e("button",{staticClass:"btn -small -red mlauto -text",on:{click:function(e){return t.reset("sell")}}},[e("i",{staticClass:"icon-eraser mr8"}),t._v(" Reset ")])]):t._e(),t.sellError?e("p",{staticClass:"form-feedback"},[e("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.sellError)+" ")]):t._e()])])}),[],!1,null,"181e4d1c",null,null).exports;var H=Object.defineProperty,G=Object.getOwnPropertyDescriptor;let R=class extends b{constructor(){super(...arguments),e(this,"paneId"),e(this,"threshold"),e(this,"canDelete")}get isLegacy(){return"trades"===this.$store.state.panes.panes[this.paneId].type}formatAmount(t){return h(t)}removeThreshold(){this.canDelete?(this.$store.commit(this.paneId+"/DELETE_THRESHOLD",this.threshold.id),this.$emit("input",null)):d.confirm({message:"You can't delete the threshold because there is only 2 and the minimum is 2",cancel:null})}};R=((t,e,s,i)=>{for(var o,n=i>1?void 0:i?G(e,s):e,a=t.length-1;a>=0;a--)(o=t[a])&&(n=(i?o(e,s,n):o(n))||n);return i&&n&&H(e,s,n),n})([v({name:"ThresholdDropdown",components:{ColorPickerControl:y},props:{paneId:{type:String,required:!0},threshold:{required:!0},canDelete:{default:!1}}})],R);const N=s(R,(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"threshold-dropdown"},[e("h3",[t._v("@ "+t._s(t.formatAmount(t.threshold.amount)))]),e("div",{staticClass:"form-group mb8 threshold-panel__gif"},[e("div",{staticClass:"column"},[t.isLegacy?e("div",{staticClass:"form-group"},[e("label",[t._v("Buy gif")]),e("input",{staticClass:"form-control w-100",attrs:{type:"text",placeholder:"Giphy keyword"},domProps:{value:t.threshold.buyGif},on:{change:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_GIF",{id:t.threshold.id,side:"buy",value:e.target.value})}}})]):t._e(),t.isLegacy?e("div",{staticClass:"form-group"},[e("label",[t._v("Sell gif")]),e("input",{staticClass:"form-control w-100",attrs:{type:"text",placeholder:"Giphy keyword"},domProps:{value:t.threshold.sellGif},on:{change:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_GIF",{id:t.threshold.id,side:"sell",value:e.target.value})}}})]):t._e()])]),e("div",{staticClass:"form-group mb8 threshold-panel__colors"},[e("label",[t._v("Custom colors")]),e("div",{staticClass:"column mt8"},[e("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"bottom"},expression:"{ placement: 'bottom' }"}],staticClass:"form-group column flex-center",attrs:{title:"When buy"}},[e("p",{staticClass:"help-text -center mr16 mt0 mb0"},[t._v("Buy")]),e("color-picker-control",{attrs:{label:"Buy color",value:t.threshold.buyColor},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:t.threshold.id,side:"buyColor",value:e})}}})],1),e("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"bottom"},expression:"{ placement: 'bottom' }"}],staticClass:"form-group column flex-center",attrs:{title:"When sell"}},[e("p",{staticClass:"help-text -center mr16 mt0 mb0"},[t._v("Sell")]),e("color-picker-control",{attrs:{label:"Sell color",value:t.threshold.sellColor},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:t.threshold.id,side:"sellColor",value:e})}}})],1)])]),e("button",{staticClass:"btn -red mt16",attrs:{type:"button"},on:{click:t.removeThreshold}},[e("i",{staticClass:"icon-trash mr8"}),t._v(" Remove ")])])}),[],!1,null,"0a27bb8b",null,null).exports;const M=s({mixins:[n],data:()=>({includeAmounts:!1,includeColors:!0,includeAudio:!0}),methods:{submit(){this.close({amounts:this.includeAmounts,colors:this.includeColors,audios:this.includeAudio})}}},(function(){var t=this,e=t._self._c;return e("Dialog",{on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"dialog__title"},[t._v("Configure preset")])]},proxy:!0},{key:"footer",fn:function(){return[e("button",{staticClass:"btn -text mr8",attrs:{type:"button"},on:{click:function(e){return t.close(!1)}}},[t._v(" Cancel ")]),e("button",{staticClass:"btn -large -green",attrs:{type:"button"},on:{click:t.submit}},[e("i",{staticClass:"icon-check mr4"}),t._v(" Submit ")])]},proxy:!0}])},[e("form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"form-group mb8"},[e("label",[t._v("Choose what to include in preset")]),e("label",{staticClass:"checkbox-control mt16"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeAmounts,expression:"includeAmounts"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeAmounts)?t._i(t.includeAmounts,null)>-1:t.includeAmounts},on:{change:function(e){var s=t.includeAmounts,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&(t.includeAmounts=s.concat([null])):n>-1&&(t.includeAmounts=s.slice(0,n).concat(s.slice(n+1)))}else t.includeAmounts=o}}}),e("div"),e("span",[t._v("Amounts")])])]),e("div",{staticClass:"form-group mb8"},[e("label",{staticClass:"checkbox-control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeColors,expression:"includeColors"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeColors)?t._i(t.includeColors,null)>-1:t.includeColors},on:{change:function(e){var s=t.includeColors,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&(t.includeColors=s.concat([null])):n>-1&&(t.includeColors=s.slice(0,n).concat(s.slice(n+1)))}else t.includeColors=o}}}),e("div"),e("span",[t._v("Colors")])])]),e("div",{staticClass:"form-group mb8"},[e("label",{staticClass:"checkbox-control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeAudio,expression:"includeAudio"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeAudio)?t._i(t.includeAudio,null)>-1:t.includeAudio},on:{change:function(e){var s=t.includeAudio,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&(t.includeAudio=s.concat([null])):n>-1&&(t.includeAudio=s.slice(0,n).concat(s.slice(n+1)))}else t.includeAudio=o}}}),e("div"),e("span",[t._v("Audio")])])])])])}),[],!1,null,null,null,null).exports;var q=Object.defineProperty,F=Object.getOwnPropertyDescriptor;let U=class extends b{constructor(){super(...arguments),e(this,"paneId"),e(this,"thresholds"),e(this,"type"),e(this,"rendering",!0),e(this,"dragging",null),e(this,"editing",null),e(this,"selectedThresholdId",null),e(this,"selectedSliderHandle",null),e(this,"thresholdPanelTrigger",null),e(this,"_dragReference",null),e(this,"movedAmount"),e(this,"_minimum",null),e(this,"_maximum",null),e(this,"_offsetLeft",null),e(this,"_onStoreMutation"),e(this,"_startDrag"),e(this,"_endDrag"),e(this,"_doDrag"),e(this,"_doResize"),e(this,"_width"),e(this,"$refs")}get selectedThreshold(){return this.$store.getters[this.paneId+"/getThreshold"](this.selectedThresholdId)}get showThresholdsAsTable(){return this.$store.state.settings.showThresholdsAsTable}get useAudio(){return this.$store.state.settings.useAudio}get capToLastThreshold(){return this.thresholds[this.thresholds.length-1].max}created(){this._onStoreMutation=this.$store.subscribe((t=>{switch(t.type){case this.paneId+"/TOGGLE_SETTINGS_PANEL":case this.paneId+"/TOGGLE_THRESHOLDS_TABLE":(t.type===this.paneId+"/TOGGLE_SETTINGS_PANEL"&&"thresholds"===t.payload||t.type===this.paneId+"/TOGGLE_THRESHOLDS_TABLE"&&!1===t.payload)&&(this.rendering=!0,this.refreshHandlers(),this.refreshGradients());break;case this.paneId+"/SET_THRESHOLD_AMOUNT":case this.paneId+"/DELETE_THRESHOLD":case this.paneId+"/ADD_THRESHOLD":this.reorderThresholds(),this.refreshHandlers();break;case this.paneId+"/SET_THRESHOLD_COLOR":this.refreshGradients()}}))}mounted(){this.showThresholdsAsTable||(this.refreshHandlers(),this.refreshGradients()),this._startDrag=this.startDrag.bind(this),this.$el.addEventListener("touchstart",this._startDrag,!1),this.$el.addEventListener("mousedown",this._startDrag,!1),this._doDrag=this.doDrag.bind(this),window.addEventListener("touchmove",this._doDrag,!1),window.addEventListener("mousemove",this._doDrag,!1),this._endDrag=this.endDrag.bind(this),window.addEventListener("touchend",this._endDrag,!1),window.addEventListener("mouseup",this._endDrag,!1),this._doResize=this.refreshHandlers.bind(this),window.addEventListener("resize",this._doResize,!1)}beforeDestroy(){window.removeEventListener("touchmove",this._doDrag),window.removeEventListener("mousemove",this._doDrag),window.removeEventListener("touchend",this._endDrag),window.removeEventListener("mouseup",this._endDrag),window.removeEventListener("resize",this._doResize),this._onStoreMutation()}startDrag(t){if(!t.target.classList.contains("thresholds-slider__handler"))return;let e=t.pageX;t.touches&&t.touches.length&&(e=t.touches[0].pageX),this.selectThreshold(t.target.getAttribute("data-id"),t),this.selectedSliderHandle=t.target,this.$nextTick((()=>{this._dragReference={timestamp:Date.now(),position:e}}))}selectThreshold(t,e){this.thresholdPanelTrigger&&this.selectedThresholdId===t||(this.selectedThresholdId=t,this.selectedThresholdId&&(this.thresholdPanelTrigger=e.target))}doDrag(t){let e=t.pageX;if(t.touches&&t.touches.length&&(e=t.touches[0].pageX),null===this.selectedSliderHandle||!this._dragReference||Date.now()-this._dragReference.timestamp<1e3&&Math.abs(this._dragReference.position-e)<3)return;this.dragging=!0;const s=Math.max(0,Math.log(this._minimum+1)||0)/Math.log(this._maximum+1)*this._width,i=Math.max(this._width/3*-1,Math.min(1.5*this._width,e-this._offsetLeft));let o=Math.exp((s+i/this._width*(this._width-s))/this._width*Math.log(this._maximum+1))-1;o<0&&(o=0),this.movedAmount=o,this.selectedSliderHandle.style.transform="translateX("+i+"px)"}endDrag(){this.selectedSliderHandle&&(this.selectedSliderHandle=null,this.reorderThresholds(),this.refreshHandlers(),this.refreshGradients(),"number"==typeof this.movedAmount&&this.$store.commit(this.paneId+"/SET_THRESHOLD_AMOUNT",{id:this.selectedThresholdId,value:this.movedAmount})),this.dragging=!1,this.movedAmount=null}async refreshHandlers(){await _(100);const t=this.thresholds.map((t=>t.amount));if(this._minimum=this.thresholds[0].amount,this._maximum=Math.max.apply(null,t),this.showThresholdsAsTable)return;const e=this.$refs.thresholdContainer.getBoundingClientRect();this._offsetLeft=e.left,this._width=this.$refs.thresholdContainer.clientWidth;const s=this.$refs.thresholdContainer.children,i=Math.max(0,Math.log(this._minimum+1)||0),o=Math.log(this._maximum+1)-i;for(let n=0;n<this.thresholds.length;n++){const t=s[n],e=this.thresholds[n],a=Math.log(e.amount+1)-i,r=this._width*(a/o);t.style.transform="translateX("+r+"px)"}this.rendering=!1}async refreshGradients(){if(this.showThresholdsAsTable)return;await _(100);const t=Math.max(0,Math.log(this._minimum+1)||0),e=Math.log(this._maximum+1),s=[],i=[];for(let o=0;o<this.thresholds.length;o++){const n=0===o?0:o===this.thresholds.length-1?100:((Math.log(this.thresholds[o].amount+1)-t)/(e-t)*100).toFixed(2);s.push(`${this.thresholds[o].buyColor} ${n}%`),i.push(`${this.thresholds[o].sellColor} ${n}%`)}this.$refs.buysGradient.style.backgroundImage=`linear-gradient(to right, ${s.join(", ")})`,this.$refs.sellsGradient.style.backgroundImage=`linear-gradient(to right, ${i.join(", ")})`}reorderThresholds(){this.thresholds.sort(((t,e)=>t.amount-e.amount))}deleteThreshold(t){this.thresholds.length<=2||this.$store.commit(this.paneId+"/DELETE_THRESHOLD",t)}openThresholdAudio(t){d.open(P,{paneId:this.paneId,thresholds:this.thresholds,thresholdId:t})}formatAmount(t,e){return h(t,e)}flipSwatches(t){const e=`${t}Color`,s=this.thresholds.map((t=>t[e])).reverse();for(let i=0;i<this.thresholds.length;i++)this.$store.commit(this.paneId+"/SET_THRESHOLD_COLOR",{id:this.thresholds[i].id,side:e,value:s[i]})}toggleMaximumThreshold(t){this.$store.commit(this.paneId+"/TOGGLE_THRESHOLD_MAX",t.id)}async getPreset(){const t=await d.openAsPromise(M);if(t){if(!t.amounts&&!t.audios&&!t.colors)return;const e=[];for(const s of this.thresholds){const i={};t.amounts&&(i.amount=s.amount),t.colors&&(i.buyColor=s.buyColor,i.sellColor=s.sellColor),t.audios&&(i.buyAudio=s.buyAudio,i.sellAudio=s.sellAudio),e.push(i)}return e}}applyPreset(t){let e=t?t.data:null;const s=JSON.parse(JSON.stringify(C[this.type]));let i=null,o=null,n=null;if(e){if(Array.isArray(e)||(e=e[this.type]&&Array.isArray(e[this.type])?e[this.type]:e.thresholds&&Array.isArray(e.thresholds)?e.thresholds:Object.keys(e).reduce(((t,s)=>(isNaN(+s)||t.push(e[s]),t)),[])),!e.length)return void this.$store.dispatch("app/showNotice",{title:"Preset looks empty",type:"error"});n=void 0!==e[0].amount,i=void 0!==e[0].buyColor,o=void 0!==e[0].buyAudio;const t=n&&i&&o,a=s.length;if(t)A(this.$store.state[this.paneId][this.type],e);else{let t=this.$store.state[this.paneId][this.type][0].amount;this.$store.state[this.paneId][this.type]=A(this.$store.state[this.paneId][this.type],e).map(((e,i)=>(e.id||(e.id=T()),void 0===e.amount&&(e.amount=t),void 0===e.buyColor&&(e.buyColor=s[Math.min(i,a)].buyColor,e.sellColor=s[Math.min(i,a)].sellColor),void 0===e.buyAudio&&(e.buyAudio=s[Math.min(i,a)].buyAudio,e.sellAudio=s[Math.min(i,a)].sellAudio),t=e.amount,e)))}}else n=i=o=!0,this.$store.state[this.paneId][this.type]&&this.$store.state[this.paneId][this.type].splice(0,this.$store.state[this.paneId][this.type].length),A(this.$store.state[this.paneId][this.type],s);const a=this.$store.state[this.paneId].thresholds[0];n&&this.$store.commit(this.paneId+"/SET_THRESHOLD_AMOUNT",{id:a.id,value:a.amount}),i&&this.$store.commit(this.paneId+"/SET_THRESHOLD_COLOR",{id:a.id,side:"buy",value:a.buyColor}),o&&this.$store.commit(this.paneId+"/SET_THRESHOLD_AUDIO",{id:a.id,buyAudio:a.buyAudio,sellAudio:a.sellAudio})}};U=((t,e,s,i)=>{for(var o,n=i>1?void 0:i?F(e,s):e,a=t.length-1;a>=0;a--)(o=t[a])&&(n=(i?o(e,s,n):o(n))||n);return i&&n&&q(e,s,n),n})([v({name:"Thresholds",components:{ColorPickerControl:y,ThresholdDropdown:N},props:{paneId:{type:String,required:!0},label:{type:String,default:null},thresholds:{required:!0},type:{type:String,default:"thresholds"}}})],U);const j=s(U,(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"thresholds",class:{"-dragging":t.dragging,"-rendering":t.rendering}},[t.showThresholdsAsTable?e("table",{staticClass:"table thresholds-table"},[e("thead",[e("tr",[e("th",{attrs:{colspan:"2"}}),e("th",{staticClass:"table-action"},[e("button",{staticClass:"btn -text",on:{click:function(e){return t.flipSwatches("buy")}}},[t._v("flip")])]),e("th",{staticClass:"table-action"},[e("button",{staticClass:"btn -text",on:{click:function(e){return t.flipSwatches("sell")}}},[t._v(" flip ")])])])]),e("transition-group",{attrs:{name:"flip-list",tag:"tbody"}},t._l(t.thresholds,(function(s,i){return e("tr",{key:s.id},[e("td",{staticClass:"table-input table-min"},[i===t.thresholds.length-1?e("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control -extra-small mb4",attrs:{title:"Set as maximum amount"}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.capToLastThreshold},on:{change:function(e){return t.toggleMaximumThreshold(s)}}}),e("div")]):t._e()]),e("td",{staticClass:"table-input"},[e("div",{staticClass:"thresholds-table__threshold"},[e("i",{staticClass:"icon icon-currency"}),e("editable",{staticClass:"w-100",attrs:{placeholder:"Amount*",value:t.formatAmount(s.amount)},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_AMOUNT",{id:s.id,value:e})}}}),i===t.thresholds.length-1&&s.max?e("small",{staticClass:"text-danger",attrs:{title:"Will only show trades below that amount"}},[e("strong",[t._v("MAX")])]):t._e()],1)]),e("td",{staticClass:"table-action"},[e("color-picker-control",{attrs:{label:"Buy color",value:s.buyColor},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:s.id,side:"buyColor",value:e})}}})],1),e("td",{staticClass:"table-action"},[e("color-picker-control",{attrs:{label:"Sell color",value:s.sellColor},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:s.id,side:"sellColor",value:e})}}})],1),t.useAudio?e("td",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"thresholds-table__audio table-action",attrs:{title:"Configure threshold audio"},on:{click:function(e){return t.openThresholdAudio(s.id)}}},[e("button",{staticClass:"btn -text"},[e("i",{staticClass:"icon-music-note"})])]):t._e(),e("td",{staticClass:"table-action",on:{click:function(e){return t.selectThreshold(s.id,e)}}},[e("button",{staticClass:"btn -text"},[e("i",{staticClass:"icon-more"})])])])})),0)],1):e("div",{staticClass:"thresholds-slider"},[e("div",{staticClass:"thresholds-gradients"},[e("div",{ref:"buysGradient",staticClass:"thresholds-gradients__buys"}),e("div",{ref:"sellsGradient",staticClass:"thresholds-gradients__sells"})]),e("div",{ref:"thresholdContainer",staticClass:"thresholds-slider__bar"},t._l(t.thresholds,(function(s){return e("div",{key:s.id,staticClass:"thresholds-slider__handler",class:{"-selected":t.selectedThresholdId===s.id},attrs:{"data-id":s.id,"data-amount":t.formatAmount(s.amount,2)}})})),0)]),e("div",{staticClass:"d-flex mt8"},[e("presets",{staticClass:"mrauto",attrs:{type:"threshold",placeholder:"Custom thresholds",adapter:t.getPreset,classes:"btn -green -small -center"},on:{apply:function(e){return t.applyPreset(e)}}}),e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -nowrap -text -start",attrs:{type:"button",title:"Add a threshold"},on:{click:function(e){return t.$store.commit(t.paneId+"/ADD_THRESHOLD",t.type)}}},[e("i",{staticClass:"icon-plus"})])],1),e("dropdown",{attrs:{interactive:""},model:{value:t.thresholdPanelTrigger,callback:function(e){t.thresholdPanelTrigger=e},expression:"thresholdPanelTrigger"}},[e("threshold-dropdown",{attrs:{threshold:t.selectedThreshold,"pane-id":t.paneId,"can-delete":t.thresholds.length>2},on:{input:function(e){t.thresholdPanelTrigger=e}}})],1)],1)}),[],!1,null,null,null,null).exports;var z=Object.defineProperty,W=Object.getOwnPropertyDescriptor;let B=class extends b{constructor(){super(...arguments),e(this,"paneId"),e(this,"type"),e(this,"side")}get thresholds(){return this.$store.state[this.paneId][this.type]}get name(){return`${this.side}Color`}get color(){const t=this.thresholds[1][this.name];if(!t)return null;const e=w(t);return e[3]=1,x(e)}async regenerateSwatch(t){this.$store.dispatch(`${this.paneId}/generateSwatch`,{type:this.type,side:this.side,baseVariance:.33,color:t}),this.$store.state[this.paneId][this.type]=JSON.parse(JSON.stringify(this.$store.state[this.paneId][this.type])),this.$store.commit(this.paneId+"/SET_THRESHOLD_COLOR",{})}};B=((t,e,s,i)=>{for(var o,n=i>1?void 0:i?W(e,s):e,a=t.length-1;a>=0;a--)(o=t[a])&&(n=(i?o(e,s,n):o(n))||n);return i&&n&&z(e,s,n),n})([v({components:{ColorPickerControl:y},name:"ThresholdColor",props:{paneId:{type:String,required:!0},side:{type:String,required:!0},type:{type:String,required:!0}}})],B);const V=s(B,(function(){var t=this,e=t._self._c;return t._self._setupProxy,t.color?e("ColorPickerControl",{staticClass:"ml8",attrs:{value:t.color,label:"Buy color"},on:{input:t.regenerateSwatch},nativeOn:{click:function(t){t.stopPropagation()}}}):t._e()}),[],!1,null,null,null,null).exports;var X=Object.defineProperty,J=Object.getOwnPropertyDescriptor;let K=class extends b{constructor(){super(...arguments),e(this,"paneId"),e(this,"market")}get hasMultiplier(){return 1!==this.market.multiplier}};K=((t,e,s,i)=>{for(var o,n=i>1?void 0:i?J(e,s):e,a=t.length-1;a>=0;a--)(o=t[a])&&(n=(i?o(e,s,n):o(n))||n);return i&&n&&X(e,s,n),n})([v({components:{Slider:i},name:"TradesMarketMultiplier",props:{paneId:{type:String,required:!0},market:{type:Object,required:!0}}})],K);const Y=s(K,(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"d-flex market-multiplier",class:[!t.hasMultiplier&&"-disabled"]},[e("div",{staticClass:"market-multiplier__id",on:{dblclick:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_MULTIPLIER",{identifier:t.market.identifier,multiplier:null})}}},[e("div",{staticClass:"text-nowrap market-exchange"},[e("small",[t._v(t._s(t.market.exchange))])]),e("div",{staticClass:"text-nowrap market-pair"},[t._v(" "+t._s(t.market.pair)+" ")])]),e("div",{staticClass:"-fill -center ml16"},[e("slider",{staticStyle:{width:"100%","min-width":"150px"},attrs:{min:0,max:3,label:1!==t.market.multiplier,step:.01,showCompletion:!1,value:t.market.multiplier,editable:!1,log:""},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_MULTIPLIER",{identifier:t.market.identifier,multiplier:e})},reset:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLD_MULTIPLIER",{identifier:t.market.identifier,multiplier:1})}},scopedSlots:t._u([{key:"tooltip",fn:function({value:e}){return[t._v(" × "+t._s(+e.toFixed(2))+" ")]}}])})],1)])}),[],!1,null,"0ea994a7",null,null).exports;var Q=Object.defineProperty,Z=Object.getOwnPropertyDescriptor;let tt=class extends b{constructor(){super(...arguments),e(this,"paneId"),e(this,"secondsAgoExample","0s ago"),e(this,"_secondsAgoExampleTimeout")}get HHMM(){return(new Date).toISOString().split("T")[1].split(":").slice(0,2).join(":")}get useAudio(){return this.$store.state.settings.useAudio}get markets(){return this.$store.state.panes.panes[this.paneId].markets}get maxRows(){return this.$store.state[this.paneId].maxRows}get thresholds(){return this.$store.state[this.paneId].thresholds}get liquidations(){return this.$store.state[this.paneId].liquidations}get showLogos(){return this.$store.state[this.paneId].showLogos}get monochromeLogos(){return this.$store.state[this.paneId].monochromeLogos}get showTimeAgo(){return this.$store.state[this.paneId].showTimeAgo}get showAvgPrice(){return this.$store.state[this.paneId].showAvgPrice}get showPrices(){return this.$store.state[this.paneId].showPrices}get showTrades(){return this.$store.state[this.paneId].showTrades}get showLiquidations(){return this.$store.state[this.paneId].showLiquidations}get showPairs(){return this.$store.state[this.paneId].showPairs}get showHistograms(){return this.$store.state[this.paneId].showHistograms}get audioThreshold(){return this.$store.state[this.paneId].audioThreshold}get muted(){return this.$store.state[this.paneId].muted}get audioPitch(){return this.$store.state[this.paneId].audioPitch||1}get audioVolume(){const t=this.$store.state[this.paneId].audioVolume;return null===t?this.$store.state.settings.audioVolume:t}get thresholdsMultipler(){return this.$store.state[this.paneId].thresholdsMultipler}get disableAnimations(){return this.$store.state.settings.disableAnimations}get isLegacy(){return"trades"===this.$store.state.panes.panes[this.paneId].type}get displayGifWarning(){return this.isLegacy&&this.disableAnimations&&(this.thresholds.filter((t=>!!t.buyGif&&!!t.sellGif)).length||this.liquidations.filter((t=>!!t.buyGif&&!!t.sellGif)).length)}get multipliers(){return this.markets.map((t=>{const[e,s]=k(t),i=this.$store.state[this.paneId].multipliers[t];return{exchange:e,pair:s,multiplier:isNaN(i)?1:i,identifier:t}}))}get mutipliersCount(){return this.multipliers.filter((t=>1!==t.multiplier)).length}get gradient(){return[this.$store.state[this.paneId].thresholds[0].buyColor,this.$store.state[this.paneId].thresholds[this.$store.state[this.paneId].thresholds.length-1].buyColor]}get thresholdsBuyColor(){return this.thresholds[1].buyColor}get thresholdsSellColor(){return this.thresholds[1].sellColor}get liquidationsBuyColor(){return this.liquidations[1].buyColor}get liquidationsSellColor(){return this.liquidations[1].sellColor}mounted(){const t=Date.now();this._secondsAgoExampleTimeout=setInterval((()=>{this.secondsAgoExample=`${E(t)} ago`}),1e3)}beforeDestroy(){this._secondsAgoExampleTimeout&&clearTimeout(this._secondsAgoExampleTimeout)}formatAmount(t){return h(t)}};tt=((t,e,s,i)=>{for(var o,n=i>1?void 0:i?Z(e,s):e,a=t.length-1;a>=0;a--)(o=t[a])&&(n=(i?o(e,s,n):o(n))||n);return i&&n&&Q(e,s,n),n})([v({components:{Thresholds:j,Slider:i,ThresholdColor:V,ToggableSection:S,MarketMultiplier:Y,ColorPickerControl:y,ToggableGroup:L},name:"TradesSettings",props:{paneId:{type:String,required:!0}}})],tt);const et=s({components:{TradesSettings:s(tt,(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",[e("div",{staticClass:"form-group mb16"},[e("div",{staticClass:"column"},[e("div",[t._v("←")]),e("small",[t._v("Small orders")]),e("slider",{staticClass:"mt8 -fill -start",attrs:{min:.01,max:10,step:.01,"show-completion":!1,value:t.thresholdsMultipler,gradient:t.gradient,log:""},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLDS_MULTIPLER",{value:e,market:t.markets[0]})},reset:function(e){return t.$store.commit(t.paneId+"/SET_THRESHOLDS_MULTIPLER",{value:1,market:t.markets[0]})}}}),e("small",{staticClass:"text-left mlauto"},[t._v("Large orders")]),e("div",[t._v("→")])],1)]),e("br"),e("ToggableSection",{staticClass:"thresholds",attrs:{title:"Thresholds",id:"trades-thresholds",badge:t.thresholds.length,disabled:!t.showTrades,inset:""},scopedSlots:t._u([{key:"title",fn:function(){return[e("label",{staticClass:"checkbox-control -small mr0",on:{click:function(t){t.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showTrades},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showTrades")}}}),e("div")]),e("div",{staticClass:"toggable-section__title ml16"},[t._v("Trades")]),e("span",{staticClass:"badge -outline ml8 mrauto"},[t._v(t._s(t.thresholds.length))]),e("ThresholdColor",{attrs:{"pane-id":t.paneId,type:"thresholds",side:"buy"}}),e("ThresholdColor",{attrs:{"pane-id":t.paneId,type:"thresholds",side:"sell"}})]},proxy:!0}])},[e("div",{staticClass:"form-group"},[e("thresholds",{attrs:{paneId:t.paneId,thresholds:t.thresholds,label:"Trades",type:"thresholds"}})],1),t.displayGifWarning?e("div",{staticClass:"d-flex help-text"},[e("p",{staticClass:"mt0 mb0 text-success"},[e("i",{staticClass:"icon-info mr8"}),e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.$store.commit("settings/TOGGLE_ANIMATIONS")}}},[t._v("Enable animations to show gifs")])])]):t._e()]),e("ToggableSection",{staticClass:"thresholds",attrs:{id:"trades-liquidations",badge:t.liquidations.length,disabled:!t.showLiquidations,inset:""},scopedSlots:t._u([{key:"title",fn:function(){return[e("label",{staticClass:"checkbox-control -small mr0",on:{click:function(t){t.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showLiquidations},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showLiquidations")},click:function(t){t.stopPropagation()}}}),e("div")]),e("div",{staticClass:"toggable-section__title ml16"},[t._v("Liquidations")]),e("span",{staticClass:"badge -outline ml8 mrauto"},[t._v(t._s(t.liquidations.length))]),e("ThresholdColor",{attrs:{"pane-id":t.paneId,type:"liquidations",side:"buy"}}),e("ThresholdColor",{attrs:{"pane-id":t.paneId,type:"liquidations",side:"sell"}})]},proxy:!0}])},[e("div",{staticClass:"form-group"},[e("thresholds",{attrs:{paneId:t.paneId,thresholds:t.liquidations,label:"Liquidations",type:"liquidations"}})],1),t.displayGifWarning?e("div",{staticClass:"d-flex help-text"},[e("p",{staticClass:"mt0 mb0 text-success"},[e("i",{staticClass:"icon-info mr8"}),e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.$store.commit("settings/TOGGLE_ANIMATIONS")}}},[t._v("Enable animations to show gifs")])])]):t._e()]),e("ToggableSection",{attrs:{title:"Audio",id:"trades-audio",inset:""}},[e("div",{staticClass:"column mb16"},[e("div",{staticClass:"form-group text-nowrap"},[e("label",{staticClass:"checkbox-control"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox",disabled:!t.useAudio},domProps:{checked:t.muted},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_MUTED")}}}),e("div"),e("span",[t._v("Mute pane")])])]),e("div",{staticClass:"-fill ml16"},[e("label",{staticClass:"mt8 d-block text-color-base"},[t._v("Pane volume")]),e("div",{staticClass:"column"},[e("slider",{staticClass:"mrauto -fill mt8 mb8",attrs:{min:0,max:400,step:1,label:!0,disabled:t.muted,value:100*t.audioVolume,log:""},on:{input:function(e){t.$store.commit(t.paneId+"/SET_AUDIO_VOLUME",+(e/100).toFixed(2))},reset:function(e){return t.$store.commit(t.paneId+"/SET_AUDIO_VOLUME",null)}},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.audioVolume>1?"+":"")+" "+t._s(+(100*t.audioVolume).toFixed(2))+"% ")]},proxy:!0}])}),e("editable",{staticClass:"-center text-nowrap ml8",staticStyle:{"line-height":"1"},attrs:{value:"× "+t.audioVolume},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_AUDIO_VOLUME",e)}}})],1),e("label",{staticClass:"mt16 d-block text-color-base"},[t._v("Transpose")]),e("div",{staticClass:"column"},[e("slider",{staticClass:"mrauto -fill mt8 mb8",attrs:{min:.001,max:5,step:.01,showCompletion:!1,disabled:t.muted,value:t.audioPitch,log:""},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_AUDIO_PITCH",e)},reset:function(e){return t.$store.commit(t.paneId+"/SET_AUDIO_PITCH",null)}},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v("× "+t._s(t.audioPitch)+" ")]},proxy:!0}])}),e("editable",{staticClass:"-center text-nowrap ml8",staticStyle:{"line-height":"1"},attrs:{value:"× "+t.audioPitch},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_AUDIO_PITCH",e)}}})],1)])]),t.useAudio&&!t.muted?e("div",{staticClass:"form-group"},[e("label",[t._v(" Minimum for a trade to trigger a sound "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info mr8",attrs:{title:"Enter the absolute amount<br>or % of significant amount"}})]),e("editable",{staticClass:"form-control",attrs:{value:t.audioThreshold,placeholder:"10%"},on:{input:function(e){return t.$store.commit(t.paneId+"/SET_AUDIO_THRESHOLD",e)}}})],1):t._e(),t.useAudio?t._e():e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text -small -cases",attrs:{type:"button",title:"Click to enable audio"},on:{click:function(e){return t.$store.commit("settings/TOGGLE_AUDIO",!0)}}},[e("i",{staticClass:"icon-info mr8 -lower"}),t._v("Audio is currently disabled ")])]),e("ToggableSection",{attrs:{title:"Preferences",id:"trades-preferences",inset:""}},[e("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{boundary:"window",placement:"left"},expression:"{ boundary: 'window', placement: 'left' }"}],staticClass:"form-group column mb8",attrs:{title:"Number of trades rendered"}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Lines count")]),e("input",{staticClass:"form-control",attrs:{id:"trades-limit",type:"number",min:"0",max:"1000",step:"1"},domProps:{value:t.maxRows},on:{change:function(e){return t.$store.commit(t.paneId+"/SET_MAX_ROWS",e.target.value)}}})]),t.isLegacy?e("div",{staticClass:"form-group column",on:{click:function(e){return e.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showTimeAgo")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Time format")]),e("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control -auto checkbox-control-input -unshrinkable",attrs:{title:"Time format preference"}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showTimeAgo}}),e("div",{attrs:{on:t.secondsAgoExample,off:t.HHMM}})])]):t._e(),t.isLegacy?t._e():e("div",{staticClass:"form-group column mb8",on:{click:function(e){return e.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showHistograms")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Histogram")]),e("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input",attrs:{title:"Rolling delta histogram"},on:{click:function(t){t.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showHistograms}}),e("div",{on:{click:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showHistograms")}}})])])]),e("ToggableSection",{attrs:{title:"Formats",id:"trades-columns",inset:""}},[e("div",{staticClass:"form-group mb8"},[e("label",{staticClass:"checkbox-control -small"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showPairs},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showPairs")}}}),e("div"),e("span",[t._v(" Show pairs "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:"Show symbol's names<br>(ex: BTC-USD)"}})])])]),e("toggable-group",{staticClass:"mb8 mt16",attrs:{value:t.showPrices,label:"Show prices",small:""},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showPrices")}}},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"checkbox-control -small"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showAvgPrice},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showAvgPrice")}}}),e("div"),e("span",[t._v(" Weighted average "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:"Show the weighted average price instead of the last price for aggregated trade results"}})])])])]),t.isLegacy?e("toggable-group",{staticClass:"mb8 mt16",attrs:{value:t.showLogos,label:"Show logos",small:""},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showLogos")}}},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"checkbox-control -small"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.monochromeLogos},on:{change:function(e){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","monochromeLogos")}}}),e("div"),e("span",[t._v(" Monochrome logos ")])])])]):t._e()],1),t.isLegacy?e("ToggableSection",{attrs:{title:`THRESHOLD MULTIPLIER (${t.mutipliersCount})`,inset:""}},[t.multipliers.length?e("div",{staticClass:"form-group"},[e("label",[e("div",{staticClass:"d-flex"},[e("div",[t._v("← Decrease threshold")]),e("div",{staticClass:"text-right mlauto"},[t._v("Increase threshold →")])])]),e("div",{staticClass:"multipliers"},t._l(t.multipliers,(function(s){return e("MarketMultiplier",{key:s.identifier,attrs:{"pane-id":t.paneId,market:s}})})),1)]):e("p",{staticClass:"mb0"},[t._v(" No active markets, "),e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.$store.dispatch("app/showSearch",{paneId:t.paneId})}}},[t._v(" add markets")]),t._v(". ")])]):t._e()],1)}),[],!1,null,"cd2f1d21",null,null).exports},mixins:[n,I]},(function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"pane-dialog",attrs:{size:"medium"},on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"dialog__title -editable",domProps:{textContent:t._s(t.name)},on:{dblclick:t.renamePane}}),e("div",{staticClass:"column -center"})]},proxy:!0},{key:"footer",fn:function(){return[e("presets",{staticClass:"-left -top",attrs:{type:"trades",adapter:t.getPreset,placeholder:t.paneId},on:{apply:function(e){return t.resetPane(e)}}})]},proxy:!0}])},[e("trades-settings",{attrs:{paneId:t.paneId}})],1)}),[],!1,null,null,null,null).exports;export{et as default};
