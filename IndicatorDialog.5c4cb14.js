var t=Object.defineProperty,i=(i,e,o)=>(((i,e,o)=>{e in i?t(i,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[e]=o})(i,"symbol"!=typeof e?e+"":e,o),o);import{n as e,D as o,W as s,C as n,_ as a,V as r,t as c,T as l,w as d,u as p,d as u,v as h,c as m}from"./index.5c4cb14.js";import{T as v,a as g}from"./Tab.5c4cb14.js";import{I as y}from"./IndicatorDropdown.5c4cb14.js";import{g as f,A as I,a as _,b,d as O,p as C,c as T,e as w}from"./options.5c4cb14.js";const k=e({mixins:[o],props:{plotTypes:{type:Array,required:!0},keys:{type:Array,required:!0},originalKeys:{type:Array,default:null}},data(){return{selection:this.keys.reduce(((t,i)=>(t[i]=!(!this.originalKeys||-1===this.originalKeys.indexOf(i)),t)),{}),form:{colors:!1,values:!0,script:!1}}},computed:{count(){return Object.values(this.selection).reduce(((t,i)=>(i&&t++,t)),this.form.script?1:0)},submitLabel(){if(!this.count)return"No selection";const t=this.form.script?1:0,i=this.count-t,e=[];return i&&e.push(`${i} option${i>1?"s":""}`),t&&e.push("the code"),e.join(" + ")}},mounted(){this.originalKeys||(this.form.colors=!0,this.toggleType(!0,!0))},methods:{submit(){this.close({selection:this.selection,script:this.form.script})},toggleType(t,i){for(const e of this.keys){const o=f(e,this.plotTypes);t&&"color"!==o||!t&&"color"===o||(this.selection[e]=i)}},toggleOption(t){this.selection[t]=!this.selection[t]}}},(function(){var t=this,i=t._self._c;return i("Dialog",{staticClass:"indicator-preset-dialog",attrs:{size:"medium"},on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",{staticClass:"dialog__title"},[t._v("Configure preset")])]},proxy:!0},{key:"footer",fn:function(){return[i("a",{staticClass:"btn -text mr8",attrs:{href:"javascript:void(0);"},on:{click:function(i){return t.close(!1)}}},[t._v(" Cancel ")]),i("button",{staticClass:"btn -green -pill",attrs:{type:"button"},on:{click:t.submit}},[t.count>0?i("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"badge -red ml8",attrs:{title:t.submitLabel},domProps:{textContent:t._s(t.count)}}):t._e(),i("span",[i("i",{staticClass:"icon-save mr8"}),t._v(" Save")])])]},proxy:!0}])},[i("form",{ref:"form",on:{submit:function(i){return i.preventDefault(),t.submit.apply(null,arguments)}}},[i("p",{staticClass:"mt0 mb0"},[t._v("Choose what to include")]),i("div",{staticClass:"d-flex"},[i("div",[i("div",{staticClass:"form-group mb8"},[i("label",{staticClass:"checkbox-control mt16"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.colors,expression:"form.colors"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.colors)?t._i(t.form.colors,null)>-1:t.form.colors},on:{input:function(i){return t.toggleType(!0,i.target.checked)},change:function(i){var e=t.form.colors,o=i.target,s=!!o.checked;if(Array.isArray(e)){var n=t._i(e,null);o.checked?n<0&&t.$set(t.form,"colors",e.concat([null])):n>-1&&t.$set(t.form,"colors",e.slice(0,n).concat(e.slice(n+1)))}else t.$set(t.form,"colors",s)}}}),i("div"),i("span",[t._v("Colors")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",distance:16},expression:"{ placement: 'top', distance: 16 }"}],staticClass:"icon-info pl4",attrs:{title:"Toggle all color options"}})])]),i("div",{staticClass:"form-group mb8"},[i("label",{staticClass:"checkbox-control"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.values,expression:"form.values"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.values)?t._i(t.form.values,null)>-1:t.form.values},on:{input:function(i){return t.toggleType(!1,i.target.checked)},change:function(i){var e=t.form.values,o=i.target,s=!!o.checked;if(Array.isArray(e)){var n=t._i(e,null);o.checked?n<0&&t.$set(t.form,"values",e.concat([null])):n>-1&&t.$set(t.form,"values",e.slice(0,n).concat(e.slice(n+1)))}else t.$set(t.form,"values",s)}}}),i("div"),i("span",[t._v("Options")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",distance:16},expression:"{ placement: 'top', distance: 16 }"}],staticClass:"icon-info pl4",attrs:{title:"Toggle all other options"}})])]),i("div",{staticClass:"form-group mb8"},[i("label",{staticClass:"checkbox-control"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.script,expression:"form.script"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.script)?t._i(t.form.script,null)>-1:t.form.script},on:{change:function(i){var e=t.form.script,o=i.target,s=!!o.checked;if(Array.isArray(e)){var n=t._i(e,null);o.checked?n<0&&t.$set(t.form,"script",e.concat([null])):n>-1&&t.$set(t.form,"script",e.slice(0,n).concat(e.slice(n+1)))}else t.$set(t.form,"script",s)}}}),i("div"),i("span",[t._v("Script")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",distance:16},expression:"{ placement: 'top', distance: 16 }"}],staticClass:"icon-info pl4",attrs:{title:"Include script in preset"}})])])])]),i("div",{staticClass:"indicator-preset-dialog__grid mt8"},[t._l(t.keys,(function(e,o){return i("button",{key:o,staticClass:"btn indicator-preset-dialog__item -small",class:[t.selection[e]?"-green":"-text"],attrs:{type:"button"},on:{click:function(i){return t.toggleOption(e)}}},[t._v(" "+t._s(e)+" ")])})),i("button",{staticClass:"btn indicator-preset-dialog__item -small",class:[t.form.script?"-green":"-text"],attrs:{type:"button"},on:{click:function(i){t.form.script=!t.form.script}}},[t._v(" Script ")])],2)])])}),[],!1,null,"ce1bb4e2",null,null).exports;var x=Object.defineProperty,S=Object.getOwnPropertyDescriptor,P=(t,i,e,o)=>{for(var s,n=o>1?void 0:o?S(i,e):i,a=t.length-1;a>=0;a--)(s=t[a])&&(n=(o?s(i,e,n):s(n))||n);return o&&n&&x(i,e,n),n};let E=class extends r{constructor(){super(...arguments),i(this,"indicatorId"),i(this,"paneId"),i(this,"plotTypes"),i(this,"name"),i(this,"ensure"),i(this,"type",null),i(this,"value",null)}get currentIndicatorValue(){return this.$store.state[this.paneId].indicators[this.indicatorId].options[this.name]}get definition(){return this.$store.state[this.paneId].indicators[this.indicatorId].optionsDefinitions[this.name]||{}}get label(){return this.definition.label||this.name}get componentName(){return this.type?"lineType"===this.name?"IndicatorOptionLineType":"lineStyle"===this.name?"IndicatorOptionLineStyle":`IndicatorOption${this.type[0].toUpperCase()}${this.type.toLowerCase().slice(1)}`:"IndicatorOptionText"}onDefinitionChange(){this.type=this.getType()}onIndicatorValueChange(){const t=this.getValue();(+this.value!=+t||isNaN(+this.value)&&t!==this.value)&&(this.value=t)}created(){this.value=this.getValue(),this.type=this.getType(),this.ensure&&void 0===this.currentIndicatorValue&&"null"!==this.value&&this.setValue(this.value)}getType(){const t=this.definition.type||f(this.name,this.plotTypes,!0,this.currentIndicatorValue);return Object.values(I).includes(t)?t:"number"}getValue(){let t;if(void 0!==this.currentIndicatorValue&&(t=this.currentIndicatorValue),void 0===t&&void 0!==this.definition.default)return this.definition.default;const i=_(this.name,this.plotTypes);return void 0!==t?t&&"object"==typeof t&&i&&"object"==typeof i?Object.assign({},i,t):t:void 0!==i?i:null}setValue(t){this.$emit("change",{key:this.name,value:t}),this.value=t,this.type=this.getType()}};P([s("definition")],E.prototype,"onDefinitionChange",1),P([s("currentIndicatorValue")],E.prototype,"onIndicatorValueChange",1),E=P([n({name:"IndicatorOptions",components:{IndicatorOptionNumber:()=>a((()=>import("./IndicatorOptionNumber.5c4cb14.js")),["IndicatorOptionNumber.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionText:()=>a((()=>import("./IndicatorOptionText.5c4cb14.js")),["IndicatorOptionText.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionList:()=>a((()=>import("./IndicatorOptionList.5c4cb14.js")),["IndicatorOptionList.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionLineStyle:()=>a((()=>import("./IndicatorOptionLineStyle.5c4cb14.js")),["IndicatorOptionLineStyle.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionLineType:()=>a((()=>import("./IndicatorOptionLineType.5c4cb14.js")),["IndicatorOptionLineType.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionExchange:()=>a((()=>import("./IndicatorOptionExchange.5c4cb14.js")),["IndicatorOptionExchange.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionRange:()=>a((()=>import("./IndicatorOptionRange.5c4cb14.js")),["IndicatorOptionRange.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js","IndicatorOptionRange.5c4cb14.css"]),IndicatorOptionCheckbox:()=>a((()=>import("./IndicatorOptionCheckbox.5c4cb14.js")),["IndicatorOptionCheckbox.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js","IndicatorOptionCheckbox.5c4cb14.css"]),IndicatorOptionColor:()=>a((()=>import("./IndicatorOptionColor.5c4cb14.js")),["IndicatorOptionColor.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js","IndicatorOptionColor.5c4cb14.css"])},props:{indicatorId:{type:String,required:!0},paneId:{type:String,required:!0},plotTypes:{required:!0},name:{type:String,required:!0},ensure:{type:Boolean,default:!1}}})],E);const K=e(E,(function(){var t=this,i=t._self._c;return t._self._setupProxy,i("div",{staticClass:"indicator-option"},[t.type?i(t.componentName,{tag:"component",attrs:{"pane-id":t.paneId,"indicator-id":t.indicatorId,label:t.label,value:t.value,definition:t.definition},on:{input:function(i){return t.setValue(i)}},scopedSlots:t._u([t.definition.description?{key:"description",fn:function(){return[i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{followCursor:!0,distance:24},expression:"{ followCursor: true, distance: 24 }"}],staticClass:"icon-info pl4",attrs:{title:t.definition.description}})]},proxy:!0}:null],null,!0)}):t._e()],1)}),[],!1,null,null,null,null).exports;var N=Object.defineProperty,$=Object.getOwnPropertyDescriptor,j=(t,i,e,o)=>{for(var s,n=o>1?void 0:o?$(i,e):i,a=t.length-1;a>=0;a--)(s=t[a])&&(n=(o?s(i,e,n):s(n))||n);return o&&n&&N(i,e,n),n};let A=class extends r{constructor(){super(...arguments),i(this,"value"),i(this,"imageObjectUrl",null)}onBlobChange(){this.loadBlob()}beforeDestroy(){this.clearBlob()}loadBlob(){this.clearBlob(),(this.value instanceof Blob||this.value instanceof File)&&(this.imageObjectUrl=URL.createObjectURL(this.value))}clearBlob(){this.imageObjectUrl&&(URL.revokeObjectURL(this.imageObjectUrl),this.imageObjectUrl=null)}};j([s("value",{immediate:!0})],A.prototype,"onBlobChange",1),A=j([n({name:"BlobImage",props:{value:{type:[Blob,File],default:null}}})],A);const D=e(A,(function(){var t=this,i=t._self._c;return t._self._setupProxy,t.imageObjectUrl?i("img",{attrs:{src:t.imageObjectUrl}}):t._e()}),[],!1,null,null,null,null).exports,L=["crosshairMarkerVisible","minLength","visible","priceScaleId","priceFormat"];const V=e({components:{Tabs:v,Tab:g,IndicatorOption:K,DropdownButton:c,ToggableSection:l,BlobImage:D,IndicatorDropdown:y,Editor:()=>a((()=>import("./Editor.5c4cb14.js")),["Editor.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","editor.5c4cb142.js","options.5c4cb14.js","editor.5c4cb142.css","Editor.5c4cb14.css"])},props:["paneId","indicatorId"],mixins:[o],data:()=>({code:"",navigation:{optionsQuery:"",editorOptions:{},columnWidth:240,tab:"options"},resizingColumn:!1,loadedEditor:!1,savedPreview:null,plotTypes:[],defaultOptionsKeys:[],scriptOptionsKeys:[],colorOptionsKeys:[],dropdownIndicatorTrigger:null,helps:{priceScaleId:"Use <u>right</u> for binding indicator to main price scale. Otherwise use it as an id to align multiple indicator on same scale (as overlay)",lastValueVisible:"Show last value on right axis",priceLineVisible:"Show horizontal line at current value",borderVisible:"Only for candlestick series, enable borders of candles",lineWidth:"Only for line and area series",lineStyle:"Only for line and area series",lineType:"Only for line and area series"},ensureOptionValue:!0}),computed:{indicator(){return this.$store.state[this.paneId].indicators[this.indicatorId]},libraryId(){return this.indicator.libraryId||this.indicatorId},displayName(){return this.indicator.displayName},displayId(){const t=this.libraryId;return t?t.length<=16?t:t.slice(0,6)+".."+t.substr(-6):"n/a"},presetPlaceholder(){return`${this.indicator.name.replace(/\{.*\}/,"").trim()} preset`},description(){return this.indicator.description},unsavedChanges(){return this.indicator.unsavedChanges},error(){return this.$store.state[this.paneId].indicatorsErrors[this.indicatorId]},name(){return this.indicator.displayName||this.indicator.name},script(){return this.indicator.script},precision(){return!this.indicator.options.priceFormat||this.indicator.options.priceFormat.auto?"auto":"number"==typeof this.indicator.options.priceFormat.precision?this.indicator.options.priceFormat.precision:2},priceFormat(){return this.indicator.options.priceFormat&&this.indicator.options.priceFormat.type||"price"},availableScales(){return b(this.$store.state[this.paneId].indicators,this.indicatorId)},queryOptionsKeys(){if(!this.navigation.optionsQuery.length)return[];const t=new RegExp(this.navigation.optionsQuery,"i");return[...this.scriptOptionsKeys,...this.defaultOptionsKeys,...this.colorOptionsKeys].filter((i=>t.test(i)))},lastPreset:{get(){return this.indicator.lastPreset?this.indicator.lastPreset:"Presets"},set(t){this.indicator.lastPreset=t&&t.name||null}}},watch:{script:{handler(t){this.code=t},immediate:!0}},created(){this.restoreNavigation(),this.getSavedPreview(),this.$nextTick((()=>{this.getPlotTypes(),this.getOptionsKeys()})),this.originalIndicator=JSON.parse(JSON.stringify(this.indicator))},beforeDestroy(){this.saveNavigation()},methods:{async getSavedPreview(){const t=await d.getIndicator(this.libraryId);this.savedPreview=null==t?void 0:t.preview},toggleCollapseColum(){this.navigation.columnWidth>50?this.navigation.columnWidth=0:this.navigation.columnWidth=240,this.resizeEditor()},handleColumnResize(t){this.resizingColumn=!0;let i=p(t).x;const e=t=>{const e=p(t).x;this.navigation.columnWidth+=i-e,i=e},o=t=>{t instanceof MouseEvent?(document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",o)):(document.removeEventListener("touchmove",e),document.removeEventListener("touchend",o)),this.navigation.columnWidth<50&&(this.navigation.columnWidth=0),this.resizeEditor(),this.resizingColumn=!1};t instanceof MouseEvent?(document.addEventListener("mousemove",e),document.addEventListener("mouseup",o)):(document.addEventListener("touchmove",e),document.addEventListener("touchend",o))},restoreNavigation(){const t=this.$store.state.settings.indicatorDialogNavigation;if(t)try{const i=JSON.parse(t);for(const t in i)this.navigation[t]=i[t]}catch(i){}},saveNavigation(){this.$store.commit("settings/SET_INDICATOR_DIALOG_NAVIGATION",this.navigation)},setPriceScale(t){this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:"priceScaleId",value:t})},updateScript(t){this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId,value:t?t.trim():void 0}),this.getPlotTypes(),this.getOptionsKeys()},updateIndicatorOptions(t){this.$set(this.navigation,"editorOptions",t)},getScriptOptions(t){const i=Object.keys(this.indicator.optionsDefinitions||{}),e=/options\.([a-zA-Z0-9_]+)|[\s\n]*(\w[\d\w]+)[\s\n]*=[\s\n]*option\(/g;let o;do{(o=e.exec(t))&&o[1]&&-1===i.indexOf(o[1])&&i.push(o[1])}while(o);return i},getPlotTypes(){const t=Object.keys(O).map((t=>t.replace(/[^\w]/g,"")));this.plotTypes=(this.script.match(new RegExp(`(?:\\n|\\s|^)(?:plot)?(${t.join("|")})\\(`,"g"))||[]).map((t=>{const i=t.replace(/[^\w]/g,"").replace(/^plot/,"");return C[i]||i})).filter(((t,i,e)=>e.indexOf(t)===i&&O[t]))},async renameIndicator(){const t=await u.prompt({action:"Rename",input:this.$store.state[this.paneId].indicators[this.indicatorId].name});"string"==typeof t&&t!==this.name&&this.$store.dispatch(this.paneId+"/renameIndicator",{id:this.indicatorId,name:t})},async saveIndicator(){await this.$store.dispatch(this.paneId+"/saveIndicator",this.indicatorId),setTimeout((()=>{this.getSavedPreview()}),500)},async undoIndicator(){await u.confirm("Undo changes ?")&&this.$store.dispatch(this.paneId+"/undoIndicator",{libraryId:this.libraryId,indicatorId:this.indicatorId})},async getIndicatorPreset(t){const i=[...this.colorOptionsKeys,...this.scriptOptionsKeys,...this.defaultOptionsKeys],e=await u.openAsPromise(k,{keys:i,plotTypes:this.plotTypes,originalKeys:t?Object.keys(t.data.options):this.scriptOptionsKeys});if(e){if(void 0===Object.values(e.selection).find((t=>!!t))&&!e.script)return void this.$store.dispatch("app/showNotice",{title:"You did not select anything to save in the preset !",type:"error"});const t={options:{}};for(const o of i)e.selection[o]&&(t.options[o]=T(this.paneId,this.indicatorId,o,this.plotTypes));return e.script&&(t.script=this.script),t}},getOptionsKeys(){const t=this.getScriptOptions(this.script),i=[...Object.keys(w),...this.plotTypes.reduce(((t,i)=>[...t,...Object.keys(O[i]||{})]),[]),...t].filter(((t,i,e)=>-1===L.indexOf(t)&&e.indexOf(t)==i)),e=[],o=[],s=[];for(let n=0;n<i.length;n++){const a=i[n];"color"===f(a,this.plotTypes,!1,this.indicator.options[a])?e.push(i.shift()):-1!==t.indexOf(a)?o.push(i.shift()):s.push(i.shift()),n--}this.scriptOptionsKeys=o,this.defaultOptionsKeys=s,this.colorOptionsKeys=e},applyIndicatorPreset(t){const i=t?t.data:null,e=this.$store.state[this.paneId].indicators[this.indicatorId];if(this.lastPreset=t,i)h(e,i);else{const t=this.scriptOptionsKeys.concat(this.defaultOptionsKeys,this.colorOptionsKeys);for(const i of t){const t=this.getDefaultValue(i);void 0!==t&&(e.options[i]=t)}}this.otherOptionsKeys=this.colorOptionsKeys=[],this.$nextTick((()=>{this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId}),this.getPlotTypes(),this.getOptionsKeys(),this.$store.commit(this.paneId+"/FLAG_INDICATOR_AS_UNSAVED",this.indicatorId)}))},setPriceFormat(t,i){let e=!1,o=Math.round(i);(""===i||isNaN(o))&&(e=!0,o=2);const s={type:t,precision:o,minMove:1/Math.pow(10,o),auto:e};this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:"priceFormat",value:s}),this.$store.commit(this.paneId+"/SET_PRICE_SCALE",{id:this.indicator.options.priceScaleId,priceScale:{...this.$store.state[this.paneId].priceScales[this.indicator.options.priceScaleId],priceFormat:{type:t,precision:o,minMove:1/Math.pow(10,o),auto:e}}})},copyIndicatorId(){m(this.indicatorId),this.$store.dispatch("app/showNotice",{title:"Copied indicator id to clipboard"})},toggleIndicatorDropdown(t){this.dropdownIndicatorTrigger?this.dropdownIndicatorTrigger=null:this.dropdownIndicatorTrigger=t.currentTarget},setIndicatorOption({key:t,value:i}){this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:t,value:i})},resizeEditor(){this.$refs.editor&&this.$refs.editor.resize()},onResize(){this.resizeEditor()},async revertChanges(t){"reset"===t?(this.ensureOptionValue=!1,this.indicator.options={priceScaleId:this.indicator.options.priceScaleId},this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId})):"revert"===t&&this.applyIndicatorPreset({data:this.originalIndicator}),this.scriptOptionsKeys=this.defaultOptionsKeys=this.colorOptionsKeys=[],await this.$nextTick(),this.getOptionsKeys()},async setTab(t){this.navigation.tab=t,"script"===this.navigation.tab&&(this.loadedEditor=!0),await this.$nextTick(),this.resizeEditor(),this.saveNavigation()}}},(function(){var t=this,i=t._self._c;return i("Dialog",{staticClass:"indicator-dialog",class:[!t.navigation.columnWidth&&"indicator-dialog--collapsed-column",t.resizingColumn&&"indicator-dialog--resizing-column"],attrs:{size:"wide",mask:!1,"close-on-escape":!1,cover:t.savedPreview,contrasted:""},on:{clickOutside:t.close,resize:t.onResize},scopedSlots:t._u([{key:"cover",fn:function(){return[i("BlobImage",{staticClass:"indicator-dialog__preview",attrs:{value:t.savedPreview}})]},proxy:!0},{key:"header",fn:function(){return[i("div",{staticClass:"dialog__title indicator-dialog__title -center mrauto"},[i("div",{on:{dblclick:t.renameIndicator}},[t._v(t._s(t.name))]),i("code",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"indicator-dialog__id -filled",attrs:{title:t.libraryId},on:{click:t.copyIndicatorId}},[i("small",[t._v(t._s(t.displayId))])])]),t.unsavedChanges?i("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn ml8 -text -no-grab indicator-dialog__action",attrs:{title:"Rollback changes"},on:{click:t.undoIndicator}},[i("i",{staticClass:"icon-eraser"}),i("span",{staticClass:"ml8"},[t._v("Discard")])]):t._e(),i("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn ml8 -no-grab indicator-dialog__action",class:[!t.unsavedChanges&&"-text",t.unsavedChanges&&"-green"],attrs:{title:"Save changes"},on:{click:t.saveIndicator}},[i("i",{staticClass:"icon-save"}),i("span",{staticClass:"ml8"},[t._v("Save")])])]},proxy:!0},{key:"subheader",fn:function(){return[i("tabs",{attrs:{value:t.navigation.tab},on:{input:t.setTab}},[i("tab",{attrs:{name:"script"}},[t._v("Script")]),i("tab",{attrs:{name:"options"}},[t._v("Options")])],1),i("IndicatorDropdown",{attrs:{"indicator-id":t.indicatorId,"pane-id":t.paneId},model:{value:t.dropdownIndicatorTrigger,callback:function(i){t.dropdownIndicatorTrigger=i},expression:"dropdownIndicatorTrigger"}},[i("DropdownButton",{staticClass:"-cases",attrs:{"button-class":"dropdown-item",options:{revert:"Revert changes",reset:"Reset to default"}},on:{input:t.revertChanges},nativeOn:{click:function(t){t.stopPropagation()}},scopedSlots:t._u([{key:"selection",fn:function(){return[i("i",{staticClass:"icon-eraser"}),t._v(" "),i("span",[t._v("Reset")])]},proxy:!0}])})],1),i("button",{staticClass:"btn -text -arrow indicator-dialog__settings",on:{click:t.toggleIndicatorDropdown}},[t._v(" Settings ")])]},proxy:!0},{key:"footer",fn:function(){return[i("presets",{staticClass:"mr8 -left",attrs:{type:"indicator:"+t.libraryId,adapter:t.getIndicatorPreset,placeholder:t.presetPlaceholder,label:t.lastPreset,"show-reset":!1},on:{apply:function(i){return t.applyIndicatorPreset(i)}}})]},proxy:!0}])},[t.loadedEditor?i("div",{directives:[{name:"show",rawName:"v-show",value:"script"===t.navigation.tab,expression:"navigation.tab === 'script'"}],staticClass:"indicator-editor"},[t.error?i("p",{staticClass:"form-feedback ml16"},[i("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.error)+" ")]):t._e(),i("editor",{ref:"editor",attrs:{value:t.code,"editor-options":t.navigation.editorOptions},on:{blur:t.updateScript,options:t.updateIndicatorOptions}})],1):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:"options"===t.navigation.tab,expression:"navigation.tab === 'options'"}],staticClass:"indicator-options indicator-options--tab hide-scrollbar"},[t.scriptOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.scriptOptionsKeys.length,title:"Script options",id:"indicator-left-script"}},[i("div",{staticClass:"indicator-options__grid"},t._l(t.scriptOptionsKeys,(function(e){return i("indicator-option",{key:e,staticClass:"indicator-options__option",attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes,ensure:t.ensureOptionValue},on:{change:t.setIndicatorOption}})})),1)]):t._e(),t.colorOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.colorOptionsKeys.length,title:"Colors",id:"indicator-left-colors"}},[i("div",{staticClass:"indicator-options__grid"},t._l(t.colorOptionsKeys,(function(e){return i("indicator-option",{key:e,staticClass:"indicator-options__option",attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})})),1)]):t._e(),t.defaultOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.defaultOptionsKeys.length,title:"Other options",id:"indicator-left-other"}},[i("div",{staticClass:"indicator-options__grid"},t._l(t.defaultOptionsKeys,(function(e){return i("indicator-option",{key:e,staticClass:"indicator-options__option",attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})})),1)]):t._e()],1),i("div",{staticClass:"indicator-delimiter"},[i("div",{staticClass:"indicator-delimiter__resizer",on:{mousedown:t.handleColumnResize,touchstart:t.handleColumnResize}}),i("button",{staticClass:"btn indicator-delimiter__collapser -text",on:{click:t.toggleCollapseColum}},[i("i",{staticClass:"icon-up-thin"})])]),i("div",{staticClass:"indicator-options indicator-options--column hide-scrollbar",style:{width:t.navigation.columnWidth+"px"}},[i("div",{staticClass:"indicator-search input-group",class:[t.navigation.optionsQuery&&"indicator-search--active"]},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.navigation.optionsQuery,expression:"navigation.optionsQuery"}],staticClass:"form-control",attrs:{type:"text",placeholder:"search option..."},domProps:{value:t.navigation.optionsQuery},on:{input:function(i){i.target.composing||t.$set(t.navigation,"optionsQuery",i.target.value)}}}),t.navigation.optionsQuery?i("button",{staticClass:"btn -text -small",attrs:{type:"button"},on:{click:function(i){t.navigation.optionsQuery=""}}},[i("i",{staticClass:"icon-cross"})]):t._e()]),t.navigation.optionsQuery.length?i("div",{staticClass:"indicator-options__list indicator-search__results"},[t._l(t.queryOptionsKeys,(function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})})),t.queryOptionsKeys.length?t._e():i("p",[t._v("No results")])],2):[t.colorOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.colorOptionsKeys.length,title:"Colors",id:"indicator-right-colors"}},[i("div",{staticClass:"indicator-options__list"},t._l(t.colorOptionsKeys,(function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes,inline:""},on:{change:t.setIndicatorOption}})})),1)]):t._e(),t.scriptOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.scriptOptionsKeys.length,title:"Script",id:"indicator-right-script"}},[i("div",{staticClass:"indicator-options__list"},t._l(t.scriptOptionsKeys,(function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes,ensure:t.ensureOptionValue},on:{change:t.setIndicatorOption}})})),1)]):t._e(),t.defaultOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.defaultOptionsKeys.length,title:"Other",id:"indicator-right-default"}},[i("div",{staticClass:"indicator-options__list"},t._l(t.defaultOptionsKeys,(function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})})),1)]):t._e(),i("ToggableSection",{attrs:{title:"Scale",id:"indicator-right-scale"}},[i("div",{staticClass:"form-group"},[i("label",[t._v("Scale with "),i("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.helps.priceScaleId}})]),i("dropdown-button",{staticClass:"-outline form-control -arrow w-100",attrs:{value:t.indicator.options.priceScaleId,options:t.availableScales,placeholder:"Default scale"},on:{input:function(i){return t.setPriceScale(i)}}})],1)]),i("ToggableSection",{attrs:{title:"Format",id:"indicator-right-format"}},[i("div",{staticClass:"d-flex mb4"},[i("div",{staticClass:"mrauto"},[t._v("Format")]),i("div",[t._v("Precision")])]),i("div",{staticClass:"d-flex"},[i("dropdown-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"mr8 -outline form-control -arrow",attrs:{value:t.priceFormat,options:["price","volume","percent"],title:"Volume uses abbreviation for Million and Thousand"},on:{input:function(i){return t.setPriceFormat(i,t.precision)}}}),i("editable",{staticClass:"form-control mlauto",attrs:{value:t.precision},on:{input:function(i){return t.setPriceFormat(t.priceFormat,i)}}})],1)])]],2)])}),[],!1,null,"024d01a3",null,null).exports;export{V as default};
